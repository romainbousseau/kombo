<h1 class="text-center">Your match</h1>
<hr>
<div class="container">
  <div class="row">
  <div class="test">
    <div class="col-xs-12 col-sm-8">
      <div class="card">
        <div class="brief text-center">
          <h2> Brief </h2>
          <%= @match.brief %>
        </div>
      </div>
       <div id="calendar" class="card"></div>
    </div>
     <div class="col-xs-12 col-sm-4">
      <div id="chat" class="card">
        <div id="chat-content">
          <% @conversation.each do |message| %>
          <div class="<%= message.user == current_user ? 'message_from_current_user' : 'message_from_other_user' %>">
            <p class="username"> <%= message.user.first_name %> </p>
            <p class="message_text"> <%= message.content %> </p>
          </div>
          <% end %>
        </div><br/>
        <div class="brief text-center">
          <%= render 'chat', match: @match, message: @message %>
        </div>
      </div>
      <div class="status text-center">
          <% if @match.status == "pending" %>
    <%= link_to "Validate", validate_match_path(@match), class: "btn btn-success", method: :post %>
    <%= link_to "Decline", decline_match_path(@match), class: "btn btn-danger", method: :post %>
  <% else %>
    <%= link_to "Done", done_match_path(@match), class: "btn btn-warning", method: :post %>
  <% end %>
      </div>
    </div>

  </div>
  </div>
</div>
<%= content_for(:after_js) do %>
  <script>

    $('#calendar').fullCalendar({
      header: {
        left: 'prev,next today',
        center: 'title',
        right: 'month,agendaWeek,agendaDay'
      },
      navLinks: true, // can click day/week names to navigate views
      selectable: true,
      selectHelper: true,
      select: function(start, end) {
        var title = prompt('Event Title:');
        var eventData;
        if (title) {
          eventData = {
            title: title,
            start: start,
            end: end
          };
          $('#calendar').fullCalendar('renderEvent', eventData, true); // stick? = true
        }
        $('#calendar').fullCalendar('unselect');
      },
      editable: true,
      eventLimit: true, // allow "more" link when too many events
    });

  $('#new_message').keydown(function(e) {
    var key = e.which;
    if (key == 13) {
    // As ASCII code for ENTER key is "13"
      $('#new_message').submit(); // Submit form code
      }
  });

  </script>
<% end %>
